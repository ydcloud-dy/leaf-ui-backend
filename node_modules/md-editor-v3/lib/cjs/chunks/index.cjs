"use strict";const o=require("vue"),d=require("./config.cjs"),u=require("./vue-tsx.cjs"),E={overlay:{type:[String,Object],default:""},visible:{type:Boolean,default:!1},onChange:{type:Function,default:()=>{}},relative:{type:String,default:"html"},disabled:{type:Boolean,default:void 0}},w=o.defineComponent({name:`${d.prefix}-dropdown`,props:E,setup(e,i){const s=`${d.prefix}-dropdown-hidden`,t=o.reactive({overlayClass:[s],overlayStyle:{},triggerHover:!1,overlayHover:!1}),r=o.ref(),a=o.ref(),v=()=>{if(e.disabled)return!1;t.triggerHover=!0;const n=r.value,l=a.value;if(!n||!l)return;const c=n.getBoundingClientRect(),m=n.offsetTop,H=n.offsetLeft,L=c.height,T=c.width,S=n.getRootNode(),h=S.querySelector(e.relative)?.scrollLeft||0,C=S.querySelector(e.relative)?.clientWidth||0;let f=H-l.offsetWidth/2+T/2-h;f+l.offsetWidth>h+C&&(f=h+C-l.offsetWidth),f<0&&(f=0),t.overlayStyle={...t.overlayStyle,top:m+L+"px",left:f+"px"},e.onChange(!0)},b=()=>{if(e.disabled)return!1;t.overlayHover=!0};o.watch(()=>e.visible,n=>{n?t.overlayClass=t.overlayClass.filter(l=>l!==s):t.overlayClass.push(s)});let p=-1;const g=n=>{r.value===n.target?t.triggerHover=!1:t.overlayHover=!1,clearTimeout(p),p=window.setTimeout(()=>{!t.overlayHover&&!t.triggerHover&&e.onChange(!1)},10)};return o.onMounted(()=>{r.value.addEventListener("mouseenter",v),r.value.addEventListener("mouseleave",g),a.value.addEventListener("mouseenter",b),a.value.addEventListener("mouseleave",g)}),o.onBeforeUnmount(()=>{r.value.removeEventListener("mouseenter",v),r.value.removeEventListener("mouseleave",g),a.value.removeEventListener("mouseenter",b),a.value.removeEventListener("mouseleave",g)}),()=>{const n=u.getSlot({ctx:i}),l=u.getSlot({props:e,ctx:i},"overlay"),c=o.cloneVNode(n instanceof Array?n[0]:n,{ref:r,key:"cloned-dropdown-trigger"}),m=o.createVNode("div",{class:[`${d.prefix}-dropdown`,t.overlayClass],style:t.overlayStyle,ref:a},[o.createVNode("div",{class:`${d.prefix}-dropdown-overlay`},[l instanceof Array?l[0]:l])]);return[c,m]}}}),D={title:{type:String,default:""},visible:{type:Boolean,default:void 0},trigger:{type:[String,Object],default:void 0},onChange:{type:Function,default:void 0},overlay:{type:[String,Object],default:void 0},insert:{type:Function,default:void 0},language:{type:String,default:void 0},theme:{type:String,default:void 0},previewTheme:{type:String,default:void 0},codeTheme:{type:String,default:void 0},disabled:{type:Boolean,default:void 0},showToolbarName:{type:Boolean,default:void 0}},y=o.defineComponent({name:"DropdownToolbar",props:D,emits:["onChange"],setup(e,i){const s=o.inject("editorId"),t=r=>{e.onChange?.(r),i.emit("onChange",r)};return()=>{const r=u.getSlot({props:e,ctx:i},"trigger"),a=u.getSlot({props:e,ctx:i},"overlay"),v=u.getSlot({props:e,ctx:i});return o.createVNode(w,{relative:`#${s}-toolbar-wrapper`,visible:e.visible,onChange:t,overlay:a,disabled:e.disabled},{default:()=>[o.createVNode("button",{class:[`${d.prefix}-toolbar-item`,e.disabled&&`${d.prefix}-disabled`],title:e.title||"",disabled:e.disabled,type:"button"},[v||r])]})}}});y.install=e=>(e.component(y.name,y),e);exports.Dropdown=w;exports.DropdownToolbar=y;
